{"version":3,"sources":["views/extensions/import-export/ExportSelected.js","@core/components/extensions-header/index.js"],"names":["initialData","id","name","username","email","website","ExportSelected","useState","data","filteredData","setFilteredData","dataToExport","setDataToExport","value","setValue","modal","setModal","fileName","setFileName","fileFormat","setFileFormat","selectedRows","setSelectedRows","toggleModal","renderTableData","map","col","className","classnames","selected","includes","type","label","checked","onChange","selectedRowsArr","splice","indexOf","push","handleSelect","title","subTitle","link","sm","Ripple","color","onClick","for","bsSize","e","target","length","filter","startsWithCondition","toLowerCase","startsWith","toString","includesCondition","handleFilter","responsive","i","handleSelectAll","isOpen","toggle","onClosed","placeholder","exportArr","item","wb","XLSX","utils","json_to_sheet","wbout","book_new","book_append_sheet","writeFile","handleExport","ExtensionsHeader","props","href","rel"],"mappings":"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","file":"static/js/144.c1890c4d.chunk.js","sourcesContent":["import { Fragment, useState } from 'react'\r\nimport ExtensionsHeader from '@components/extensions-header'\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Button,\r\n  Table,\r\n  Modal,\r\n  ModalHeader,\r\n  ModalBody,\r\n  ModalFooter,\r\n  Input,\r\n  FormGroup,\r\n  CustomInput,\r\n  Label\r\n} from 'reactstrap'\r\nimport classnames from 'classnames'\r\nimport XLSX from 'xlsx'\r\n\r\nconst initialData = [\r\n  {\r\n    id: 1,\r\n    name: 'Leanne Graham',\r\n    username: 'Bret',\r\n    email: 'Sincere@april.biz',\r\n    website: 'hildegard.org'\r\n  },\r\n  {\r\n    id: 2,\r\n    name: 'Ervin Howell',\r\n    username: 'Antonette',\r\n    email: 'Shanna@melissa.tv',\r\n    website: 'anastasia.net'\r\n  },\r\n  {\r\n    id: 3,\r\n    name: 'Clementine Bauch',\r\n    username: 'Samantha',\r\n    email: 'Nathan@yesenia.net',\r\n    website: 'ramiro.info'\r\n  },\r\n  {\r\n    id: 4,\r\n    name: 'Patricia Lebsack',\r\n    username: 'Karianne',\r\n    email: 'Julianne.OConner@kory.org',\r\n    website: 'kale.biz'\r\n  },\r\n  {\r\n    id: 5,\r\n    name: 'Chelsey Dietrich',\r\n    username: 'Kamren',\r\n    email: 'Lucio_Hettinger@annie.ca',\r\n    website: 'demarco.info'\r\n  },\r\n  {\r\n    id: 6,\r\n    name: 'Mrs. Dennis Schulist',\r\n    username: 'Leopoldo_Corkery',\r\n    email: 'Karley_Dach@jasper.info',\r\n    website: 'ola.org'\r\n  },\r\n  {\r\n    id: 7,\r\n    name: 'Kurtis Weissnat',\r\n    username: 'Elwyn.Skiles',\r\n    email: 'Telly.Hoeger@billy.biz',\r\n    website: 'elvis.io'\r\n  },\r\n  {\r\n    id: 8,\r\n    name: 'Nicholas Runolfsdottir V',\r\n    username: 'Maxime_Nienow',\r\n    email: 'Sherwood@rosamond.me',\r\n    website: 'jacynthe.com'\r\n  },\r\n  {\r\n    id: 9,\r\n    name: 'Glenna Reichert',\r\n    username: 'Delphine',\r\n    email: 'Chaim_McDermott@dana.io',\r\n    website: 'conrad.com'\r\n  },\r\n  {\r\n    id: 10,\r\n    name: 'Clementina DuBuque',\r\n    username: 'Moriah.Stanton',\r\n    email: 'Rey.Padberg@karina.biz',\r\n    website: 'ambrose.net'\r\n  }\r\n]\r\n\r\nconst ExportSelected = () => {\r\n  const [data] = useState(initialData)\r\n  const [filteredData, setFilteredData] = useState([])\r\n  const [dataToExport, setDataToExport] = useState([])\r\n  const [value, setValue] = useState('')\r\n  const [modal, setModal] = useState(false)\r\n  const [fileName, setFileName] = useState('')\r\n  const [fileFormat, setFileFormat] = useState('xlsx')\r\n  const [selectedRows, setSelectedRows] = useState([])\r\n\r\n  const toggleModal = () => setModal(!modal)\r\n\r\n  const handleFilter = e => {\r\n    let filteredData = []\r\n    const value = e.target.value\r\n    setValue(value)\r\n    if (value.length) {\r\n      filteredData = data.filter(col => {\r\n        const startsWithCondition =\r\n          col.name.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.email.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.website.toLowerCase().startsWith(value.toLowerCase()) ||\r\n          col.id.toString().toLowerCase().startsWith(value.toLowerCase())\r\n\r\n        const includesCondition =\r\n          col.name.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.email.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.website.toLowerCase().includes(value.toLowerCase()) ||\r\n          col.id.toString().toLowerCase().includes(value.toLowerCase())\r\n\r\n        if (startsWithCondition) return startsWithCondition\r\n        else if (!startsWithCondition && includesCondition) return includesCondition\r\n        else return null\r\n      })\r\n      setValue(value)\r\n      setFilteredData(filteredData)\r\n    }\r\n  }\r\n\r\n  const handleExport = () => {\r\n    const exportArr = dataToExport\r\n    data.map(item => {\r\n      if (selectedRows.includes(item.id)) {\r\n        return exportArr.push(item)\r\n      } else {\r\n        return null\r\n      }\r\n    })\r\n    setDataToExport([...exportArr])\r\n    const name = fileName.length ? `${fileName}.${fileFormat}` : `excel-sheet.${fileFormat}`\r\n    const wb = XLSX.utils.json_to_sheet(dataToExport)\r\n    const wbout = XLSX.utils.book_new()\r\n    XLSX.utils.book_append_sheet(wbout, wb, 'test')\r\n    XLSX.writeFile(wbout, name)\r\n    toggleModal()\r\n  }\r\n\r\n  const handleSelect = id => {\r\n    const selectedRowsArr = selectedRows\r\n    if (!selectedRowsArr.includes(id)) {\r\n      selectedRowsArr.push(id)\r\n    } else if (selectedRowsArr.includes(id)) {\r\n      selectedRowsArr.splice(selectedRowsArr.indexOf(id), 1)\r\n    } else {\r\n      return null\r\n    }\r\n    setSelectedRows([...selectedRowsArr])\r\n  }\r\n\r\n  const handleSelectAll = () => {\r\n    let selectedRowsArr = selectedRows\r\n    if (selectedRowsArr.length < data.length) {\r\n      const ids = data.map(i => i.id)\r\n      selectedRowsArr = ids\r\n    } else if (selectedRowsArr.length === data.length) {\r\n      selectedRowsArr = []\r\n    } else {\r\n      return null\r\n    }\r\n\r\n    setSelectedRows(selectedRowsArr)\r\n  }\r\n\r\n  const array = value ? filteredData : data\r\n  const renderTableData = array.map(col => {\r\n    return (\r\n      <tr\r\n        key={col.id}\r\n        className={classnames({\r\n          selected: selectedRows.includes(col.id)\r\n        })}\r\n      >\r\n        <td>\r\n          <CustomInput\r\n            type='checkbox'\r\n            id={col.id}\r\n            label=''\r\n            checked={!!selectedRows.includes(col.id)}\r\n            onChange={() => handleSelect(col.id)}\r\n          />\r\n        </td>\r\n        <td>{col.email}</td>\r\n        <td>{col.name}</td>\r\n        <td>{col.website}</td>\r\n        <td>{col.id}</td>\r\n      </tr>\r\n    )\r\n  })\r\n\r\n  return (\r\n    <Fragment>\r\n      <ExtensionsHeader\r\n        title='XLSX'\r\n        subTitle='Xlsx is a parser and writer for various spreadsheet formats'\r\n        link='https://github.com/AdeleD/react-paginate'\r\n      />\r\n      <Row className='export-component'>\r\n        <Col sm='12'>\r\n          <Card>\r\n            <CardBody className='pb-0'>\r\n              <div className='d-flex flex-wrap justify-content-between'>\r\n                <Button.Ripple color='primary' onClick={() => toggleModal()}>\r\n                  Export Selected\r\n                </Button.Ripple>\r\n                <div className='d-flex align-items-center justify-content-end'>\r\n                  <Label for='search-input' className='mr-1'>\r\n                    Search\r\n                  </Label>\r\n                  <Input id='search-input' bsSize='sm' type='text' value={value} onChange={e => handleFilter(e)} />\r\n                </div>\r\n              </div>\r\n            </CardBody>\r\n            <Table className='table-hover-animation mt-2' responsive>\r\n              <thead>\r\n                <tr>\r\n                  <th>\r\n                    <CustomInput\r\n                      type='checkbox'\r\n                      id='select-all'\r\n                      label=''\r\n                      checked={!!selectedRows.length}\r\n                      onChange={e => handleSelectAll()}\r\n                    />\r\n                  </th>\r\n                  <th>Email</th>\r\n                  <th>Name</th>\r\n                  <th>Website</th>\r\n                  <th>Rank</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>{renderTableData}</tbody>\r\n            </Table>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      <Modal\r\n        isOpen={modal}\r\n        toggle={() => toggleModal()}\r\n        className='modal-dialog-centered'\r\n        onClosed={() => setFileName('')}\r\n      >\r\n        <ModalHeader toggle={() => toggleModal()}>Export To Excel</ModalHeader>\r\n        <ModalBody>\r\n          <FormGroup>\r\n            <Input\r\n              type='text'\r\n              value={fileName}\r\n              onChange={e => setFileName(e.target.value)}\r\n              placeholder='Enter File Name'\r\n            />\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <CustomInput\r\n              type='select'\r\n              id='selectFileFormat'\r\n              name='customSelect'\r\n              value={fileFormat}\r\n              onChange={e => {\r\n                setFileFormat(e.target.value)\r\n              }}\r\n            >\r\n              <option>xlsx</option>\r\n              <option>csv</option>\r\n              <option>txt</option>\r\n            </CustomInput>\r\n          </FormGroup>\r\n        </ModalBody>\r\n        <ModalFooter>\r\n          <Button color='primary' onClick={() => handleExport()}>\r\n            Export\r\n          </Button>\r\n          <Button color='flat-danger' onClick={() => toggleModal()}>\r\n            Cancel\r\n          </Button>\r\n        </ModalFooter>\r\n      </Modal>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default ExportSelected\r\n","// ** React Imports\nimport Proptypes from 'prop-types'\nimport { Row, Col } from 'reactstrap'\n\nconst ExtensionsHeader = props => {\n  return (\n    <Row className='mb-2'>\n      <Col sm='12' className='ml-50'>\n        <p className='font-medium-5 mt-1 extension-title' data-tour='extension-title'>\n          {props.title}\n        </p>\n        {props.link ? (\n          <a href={props.link} target='_blank' rel='noopener noreferrer'>\n            {props.subTitle}\n          </a>\n        ) : (\n          <p className='text-primary'>{props.subTitle}</p>\n        )}\n      </Col>\n    </Row>\n  )\n}\nexport default ExtensionsHeader\n\n// ** PropTypes\nExtensionsHeader.propTypes = {\n  title: Proptypes.string.isRequired,\n  subTitle: Proptypes.string.isRequired,\n  link: Proptypes.string\n}\n"],"sourceRoot":""}